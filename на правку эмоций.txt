

======================== Массаж Алисе при просмотре ТВ ============================

    Alice_00 "Нет, садись. Тут места много..."
    Max_00 "Хорошо. Что смотришь?"
    menu:
        Alice_13 "Да так, всякую ерунду. Я просто отдыхаю, и мне без разницы, что смотреть. Поэтому смотрю всё подряд..."
        "Ну, давай смотреть всё подряд...":
            Max_11 "{i}По телеку сегодня нет ничего интересного... Ни порнушки, ни даже эротики... А было бы забавно посмотреть такое с сестрёнкой...{/i}"
            Max_00 "Ладно, пойду я..."
            jump .end
        "Тебе сделать массаж ног?" if not talk_var['al.tv.mas'] and mgg.massage > 1:  # если Макс прошел хотя бы один урок массажа
            $ renpy.show("Max tv-closer 04"+mgg.dress)

    $ talk_var['al.tv.mas'] = 1
    $ _ch4 = GetChance(mgg.social, 4, 900)
    if flags['alice.tv.mass'] == 0:     # Первая беседа о массаже
        Alice_02 "Что-то новенькое... А ты умеешь?"
        Max_01 "Само собой!"
        Alice_01 "Могу я спросить откуда? Раньше ты, вроде бы, не умел. Да и не представляю, где бы ты мог этому научиться..."
        Max_02 "Онлайн-курсы!"
        menu:
            Alice_02 "Очень смешно, Макс. Разве можно научиться массажу через ютуб?"
            "Почему ютуб? Это платные курсы...":
                Alice_01 "А, ну если ты им ещё и заплатил, то это всё меняет!" nointeract
            "Конечно! Я же научился...":
                Alice_01 "Что-то я очень сомневаюсь, Макс..." nointeract
        if renpy.display_menu([(_("Так тебе продемонстрировать или как? \n{color=[_ch4.col]}(Убеждение. Шанс: [_ch4.vis]){/color}"), 1)]) == 1:
            pass
        $ flags['alice.tv.mass'] = 1
        
    elif flags['alice.tv.mass'] in range(1, 5): # Пока Алисе трижды не понравится массаж
        menu:
            Alice_02 "Ну, не знаю, не знаю..."
            "Тебе понравится! n{color=[_ch4.col]}(Убеждение. Шанс: [_ch4.vis]){/color}":
                pass
                
    else:  # Массаж понравился уже три раза
        menu:
            Alice_07 "Дай-ка подумаю... Да! Я готова..."
            "Хорошо {i}(начать массаж){/i}":
                jump .massage
            "Может конфетку перед массажем?" if kol_choco:  ### если Макс знает о слабости Алисы
                jump .choco

    if not RandomChance(_ch4.ch): ###Убеждение не удалось
        Alice_02 "[failed!t]Нет, Макс, в другой раз. Что-то я сомневаюсь. Вдруг, ты мне что-то сломаешь... Нет, спасибо."
        Max_08 "Ну, как хочешь... Не буду тебе мешать..."
        $ mgg.social += 0.05
        jump .end

    ### Убеждение удалось
    $ _drink = False
    $ mgg.social += 0.1
    menu:
        Alice_03 "[succes!t]Ну, давай. Только я очень привередлива в вопросах массажа. Если сделаешь что-то не так, сразу закончим."
        "Хорошо {i}(начать массаж){/i}":
            jump .massage
        "Может конфетку перед массажем?" if kol_choco:  ### если Макс знает о слабости Алисы
            jump .choco

    label .choco:
        if dcv['tvchoco'].done:
            menu:
                Alice_02 "У меня такое чувство, что ты чего-то от меня хочешь... Но не сознаешься ведь?"
                "Хочу тебя!":
                    menu:
                        Alice_15 "Макс! Вали нахрен отсюда со своими шуточками. Дай спокойно телевизор посмотреть!"
                        "{i}уйти{/i}":
                            jump .end
                "Просто я такой хороший парень!":
                    Alice_05 "Угу... Точно! Извини, а где мой брат Макс?"
                    Max_01 "Очень смешно. Так ты хочешь конфеты?"
                "Ты узнаешь... В своё время...":
                    Alice_02 "Звучит очень зловеще... И что же я узнаю, интересно? Ах да. Это же секрет... Самому не смешно?"
                    Max_01 "Да, да, очень! Так ты хочешь конфеты?"

    $ _ch3 = GetChance(mgg.social, 3, 900)
    menu:
        Alice_13 "Честно говоря, не знаю. Конфеты я люблю, но не хочу портить фигуру..."
        "От конфетки не поправишься! {color=[_ch3.col]}(Убеждение. Шанс: [_ch3.vis]){/color}":
            if RandomChance(_ch3.ch):
                ## Алиса съела конфетку
                $ kol_choco -= 1
                $ dcv['tvchoco'].set_lost(3)
                $ _drink = True
                if kol_choco == 0:
                    $ items['choco'].InShop = True
                    $ notify_list.append(_("Конфеты закончились"))
                $ mgg.social += 0.1
                menu:   ### Убеждение удалось
                    Alice_07 "[succes!t]Эх.. Уболтал, чертяка языкастый! Давай сюда конфетку. Но только одну... Вкусно... Теперь я готова, начинай массаж!"
                    "Ну, хорошо {i}(начать массаж){/i}":
                        jump .massage
            else:
                $ dcv['tvchoco'].set_lost(2)
                $ mgg.social += 0.05
                menu:   ###Убеждение не удалось
                    Alice_01 "[failed!t]Нет, Макс. Спасибо, конечно, но рисковать я не буду. Ну так что, массаж делать будешь или забыл, что собирался?"
                    "Ну, хорошо {i}(начать массаж){/i}":
                        jump .massage

    label .massage:
        $ _pose = {'01':'01', '03':'02', '02':renpy.random.choice(['01','02'])}[pose3_2]
        $ _dress = mgg.dress+alice.dress
        $ _ch20 = GetChance(mgg.massage, 20)
        $ _ch15 = GetChance(mgg.massage, 15)
        ### сцена массажа 01 или 02
        scene BG char Alice tv-mass-01
        $ renpy.show('Alice tv-mass ' + _pose + _dress)
        menu:
            Max_03 "{i}Какая у Алисы нежная кожа... Интересно, о чём она сейчас думает?{/i}"
            "{i}продолжить{/i} \n{color=[_ch20.col]}(Массаж. Шанс: [_ch20.vis]){/color}":
                pass
        if RandomChance(_ch20.ch):  ### {i}Алисе понравился массаж!{/i}
            $ mgg.massage += 0.1
            $ _ch2 = GetChance(mgg.social, 2)
            $ flags['alice.tv.mass'] += 1
            $ _pose = {'01':'03', '02':'04'}[_pose]
            scene BG char Alice tv-mass-03
            $ renpy.show('Alice tv-mass ' + _pose + _dress)
            menu:
                Alice_04 "[alice_good_mass!t]А ты неплох сегодня в этом деле... Хорошо, что ты никакой не работяга. Руки у тебя нежные. Приятно очень..."
                "Тебе джинсы не мешают? \n{color=[_ch2.col]}(Убеждение. Шанс: [_ch2.vis]){/color}" if alice.dress=='a':
                    if RandomChance(_ch2.ch):
                        jump .jeans
                    else:
                        $ mgg.social += 0.05
                        menu:   ### Убеждение не удалось!
                            Alice_05 "[failed!t]Это так ты к девушкам подкатываешь, сразу предлагаешь снять штаны?"
                            "Э... Я к тебе не подкатываю. Просто, жарко же...":
                                pass
                            "Ну у тебя и фантазии, Алиса... Я не подкатываю!":
                                pass
                        Alice_01 "Да шучу я. Но джинсы снимать не стану. Даже не надейся. Кстати, ты закончил с массажем? Спасибо большое, можешь идти..."
                        Max_00 "Вот так вот..."
                        jump .end

                "{i}продолжить{/i} \n{color=[_ch20.col]}(Массаж. Шанс: [_ch20.vis]){/color}" if alice.dress!='a' and not _drink:
                    jump .massage_next

                "{i}продолжить{/i} \n{color=[_ch15.col]}(Массаж. Шанс: [_ch15.vis]){/color}" if alice.dress!='a' and _drink:
                    jump .massage_next

                "{i}закончить массаж{/i}":
                    Alice_07 "Как, всё? А мне понравилось... Спасибо, Макс. Вот ты и сделал девушке приятно!"
                    Max_07 "Я и не так могу..."
                    Alice_05 "Ах ты и не так можешь? Боюсь даже представить, как... Но не буду. И тебе не советую. Так что давай, дуй отсюда!"
                    Max_00 "Угу..."
                    jump .end
        else:
            $ mgg.massage += 0.05
            menu: ### {i}Алисе не понравился массаж!{/i}
                Alice_12 "[alice_bad_mass!t]Ой, Макс, больно! Не надо так. Ты чуть лодыжку не вывихнул мне... Иди ещё потренируйся там на кошках или в ютубе поучись!"
                "{i}закончить{/i}":
                    jump .end

    label .jeans:
        $ mgg.social += 0.1
        ### Убеждение снять джинсы удалось
        if 'smoke' in talk_var and flags['smoke'] == 'nopants':  # Алиса сейчас без трусиков
            menu:   ### Убеждение удалось, но Алиса без трусов
                Alice_02 "[succes!t]Да, что-то тесновато в них и так жарко... Хотя...Не-е-ет, нет, нет! Не буду снимать я сейчас джинсы. Не дождёшься!"
                "Почему?":
                    Alice_01 "Сам догадайся, глупый. Но я намекну: возможно, под джинсами ничего нет. Понял? Всё, а теперь иди отсюда, фантазируй..."
                    Max_01 "Ух, пойду тогда... Пофантазирую где-нибудь..."
                    jump .end
                "Потому-что ты без трусиков?":
                    Alice_03 "Сам догадался, или кто подсказал? Ну всё, теперь ты всё обо мне знаешь, иди и фантазируй о чём хочешь..."
                    Max_01 "Ладно, пойду пофантазирую где-нибудь..."
                    jump .end
        else:
            Alice_04 "[succes!t]Ты знаешь, мешают. И очень жарко. Пожалуй, порадую тебя немного, раз ты так хорошо массаж делаешь..."
            Max_07 "{i}Ого...{/i}"
            ### Алиса без джинсов
            $ _dress = mgg.dress+'c'
            $ renpy.show('Alice tv-mass ' + _pose + _dress)
            menu:
                Alice_05 "Да, так гораздо лучше. Только ты не пялься, куда не надо. Вижу, краем глаза пытаешься что-то разглядеть. Вот не надо. Лучше, продолжай массаж..."
                "{i}продолжить{/i} \n{color=[_ch20.col]}(Массаж. Шанс: [_ch20.vis]){/color}" if not _drink:
                    jump .massage_next
                "{i}продолжить{/i} \n{color=[_ch15.col]}(Массаж. Шанс: [_ch15.vis]){/color}" if and _drink:
                    jump .massage_next

    label .massage_next:
        if RandomChance(ch15.ch) and _drink: ### {i}Алисе понравился массаж!{/i} Алиса съела конфетку
            $ mgg.massage += 0.1
            $ _pose = {'03':'05', '04':'06'}[_pose]
            scene BG char Alice tv-mass-05
            $ renpy.show('Alice tv-mass ' + _pose + _dress)
            menu:
                Alice_07 "Макс... Сегодня твои ручки творят чудеса... А во что это моя нога упёрлась? Это часть программы или как?"
                "Да, это будет на десерт...":
                    menu:
                        Alice_08 "Ты так в себе уверен, Макс... Забыл, что я твоя сестра? Не говори глупости... Просто продолжай массировать мои ножки. Если ты ещё не в курсе, они у меня целиком - эрогенная зона..."
                        "{i}попытаться приставать{/i}":
                            jump .fail
                        "{i}продолжать массаж{/i}":
                            pass
                "{i}продолжать молча{/i}":
                    menu:
                        Alice_04 "Эх, Макс... А я бы захотела продолжения, если бы ты был моим парнем... Жаль, что ты только мой брат..."
                        "Ну я могу стать твоим парнем... Хотя бы на час... или насколько захочешь...":
                            menu:
                                Alice_05 "На сколько захочу? На секунду! Ой. Она прошла... Всё, Макс, твоё время вышло... Ладно, засовывай свою штуку обратно. Что-то голова кружится... Макс, уйди по хорошему, а..."
                                "{i}уйти{/i}":
                                    jump .end
                        "{i}попытаться приставать{/i}":
                            jump .fail
                        "{i}продолжать массаж{/i}":
                            pass

        elif RandomChance(ch20.ch) and not _drink: ### {i}Алисе понравился массаж!{/i} конфету Алиса не ела
            $ mgg.massage += 0.1
            Alice_03 "Ух, как хорошо... Макс, а ты молодец сегодня! Не ожидала такой чувственности и в то же время силы... Ну всё спасибо, иди..."
            Max_04 "Не за что..."
            jump .end

        else: ### {i}Алисе не понравился массаж!{/i}
            $ mgg.massage += 0.05
            Alice_13 "[alice_bad_mass!t]Ой, нет, что-то не то. Ты же так хорошо начал, и что-то неприятно стало... Иди, ещё поучись этому своему массажу на ютубе. Так не пойдёт..."
            Max_00 "Ладно..."
            jump .end

    ## финал массажа с конфеткой
    # $ _pose = {'01':'03', '02':'04'}[_pose]
    # scene BG char Alice tv-mass-033
    # $ renpy.show('Alice tv-mass ' + _pose + _dress)
    Alice_04 "Ну всё, кажется хватит. Во всяком случае, тебе. А то мне ногу испачкаешь... Но ручки у тебя - что надо. Даже не ожидала такого от тебя..."
    Max_05 "Я тоже не ожидал... такого..."
    Alice_08 "Значит, мы оба полны сюрпризов. Ну всё, хорошего помаленьку. Давай, засовывай свой член обратно, а то до добра это всё дело не дойдёт... Да, и спасибо за массаж..."
    Max_03 "Тебе спасибо..."
    jump .end

    menu .fail:
        Alice_12 "Макс! Ещё одно лишнее движение, и я дам тебе по шарам вот это самой ногой. Ты меня понял? Всё, массаж окончен, вали отсюда!"
        "{i}уйти{/i}":
            jump .end


============================= Разговор с Лизой про слабость Алисы ======================


    if dcv['alice.secret'].stage < 1:
        ## Самый первый разговор на тему секрета Алисы
        Lisa_09 "Странный? Скорее, беспокойный. Переживаю насчёт Алисы..."
        Max_07 "А что такое?"
        Lisa_00 "Ну, у неё теперь есть платье для ночных клубов. Думаю, что может во что-то вляпаться, если ты меня понимаешь..."
        Max_09 "Не совсем... Ты просто переживаешь или имеешь в виду что-то конкретное?"

    $ _ch1 = GetChance(mgg.social, 1, 900)
    $ _ch4 = GetChance(mgg.social, 4, 900)
    menu:
        Lisa_10 "Алиса просила меня об этом не рассказывать... Так что..."
        "Лиза, мне можно рассказать! {color=[_ch1.col]}(Убеждение. Шанс: [_ch1.vis]){/color}" if GetRelMax('lisa')[0]<4:
            pass
        "Лиза, мне можно рассказать! {color=[_ch4.col]}(Убеждение. Шанс: [_ch4.vis]){/color}" if GetRelMax('lisa')[0]>3:
            pass

    if not any([GetRelMax('lisa')[0]>3 and RandomChance(_ch4.ch), GetRelMax('lisa')[0]<4 and RandomChance(_ch1.ch)]):
        ## Лиза не поддалась на уговоры
        Lisa_09 "[failed!t]Нет, Макс, не расскажу. Я обещала. Ты же не хочешь, чтобы твои секреты кто-то узнал, верно?"
        Max_00 "Верно..."
        $ mgg.social += 0.1
        $ dcv['alice.secret'].set_lost(2)
        $ dcv['alice.secret'].stage = 1
        $ spent_time += 10
        return

    ## Удалось убедить Лизу
    Lisa_00 "[succes!t]Ну ладно, расскажу... В общем, год назад Алиса тоже как-то пошла в ночной клуб..."
    Max_01 "Ого, любопытно..."
    Lisa_01 "Видимо, там она первый раз и попробовала алкоголь. Как рассказывала её лучшая подружка, Алиса выпила буквально один глоток шампанского, но её как подменили!"
    Max_07 "И что случилось?"
    Lisa_02 "Похоже, когда она выпивает любое количество алкоголя, даже каплю, у неё отключаются какие-то внутренние ограничители и Алиса начинает делать что попало. Причём, она не выглядит пьяной, но ведёт себя... странно. И на утро ничего не помнит, представляешь!"
    Max_04 "Спасибо, Лиза, это и правда интересно..."
    Lisa_01 "Но это всё ещё секрет. Ты же меня понимаешь?"
    Max_01 "Конечно! Я тебя не выдам..."
    $ mgg.social += 0.2
    $ poss['nightclub'].OpenStage(5)
    $ spent_time += 10
    $ items['choco'].InShop = True
    $ notify_list.append(_("В интернет-магазине доступен новый товар."))

Если не удалось узнать секрет с первого раза, то дальнейшие попытки начнутся со слов...

Max "Может всё-таки поделишься своими переживаниями по поводу Алисы?"



Дополнение со стягиванием джинсов с Алисы

Может, ещё конфетку? (убеждение)
   (удалось)
      Alice_02 "Макс, ну какой же ты... А, ладно, давай ещё одну... Но это последняя, больше не предлагай, а то пну сам знаешь куда! А эта конфета, кажется, ещё вкуснее той! От них стало так жарко..."
	  Max_01 "Может, тогда тебе стоит снять джинсы? Не будет так жарко..."
	  Alice_04 "Только давай ты снимешь их с меня сам, а то я уже так расслабилась, что двигаться не хочется."
	  Max_03 "О, это я с радостью сделаю!"
	  Alice_07 "Я немного приподнимусь, чтобы тебе было проще их стянуть..."   #спрайт со стягиванием джинсов
	  Max_05 "О да, так гораздо лучше..."   #если на Алисе есть трусики
	  Max_06 "О да, это ты классно придумала!"   #если на Алисе нет трусиков
	  Alice_05 "Ты только там сильно не заглядывайся, куда не нужно! Лучше скорее продолжай массаж, пока я не расхотела..."
	  Max_02 "Ага, сейчас продолжим..."   #если на Алисе есть трусики
	  Дальше все продолжается, как и в случае, если Алиса сама сняла джинсы.
	  Max_07 "Ну да... точно... я же... это... массаж делал."   #если на Алисе нет трусиков
	  Alice_03 "Ты чего там так тормозишь? Как будто в трусиках меня никогда не видел..."
	  стянуть джинсы до конца
	  Alice_15 "Ой, Макс, я же сегодня без них! Вот чёрт! Чего глазеешь, иди отсюда, ты и так увидел больше положенного..."   #спрайт с прикрыванием
	  Max_05 "Ладно, но это было так сногсшибательно, что я аж забыл как ходить!"
	  Alice_18 "Макс!!!"
	  Max_04 "Всё, ушёл."
   (не удалось)
      Alice_03 "Нет, мне хватит одной... А то я мигом фигуру испорчу. Лучше продолжай массировать мои ножки..."
	  Дальше вариант "Тебе джинсы не мешают? (убеждение)" и все как уже есть.